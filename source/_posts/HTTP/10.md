---
title: HTTP 协议梳理
date: 2020-09-01
categories: HTTP
tags: HTTP
toc: true
thumbnail: https://gitee.com/heptaluan/backups/raw/master/cdn/cover/10.jpg
---

最近打算从新的梳理一下 `HTTP` 的相关内容，因为在复习过程中发现博客当中很多关于 `HTTP` 的内容都是东一块西一块的混杂在一起，没有形成体系，所以就将之前的内容全都提取出来，然后重新的整理一遍，在借助一些书籍从 `HTTP` 诞生之时开始重新的梳理一遍其相关内容，也算是从零开始从新学习 `HTTP`，其实主要目的还是了解一下 `HTTP`、`TCP/IP`、`HTTPS` 等相关概念到底是什么，又是用来做什么的，更多相关内容可以参考 [前端知识体系整理](https://heptaluan.github.io/target/)，那么下面我们就先从一张思维导图开始看起

<!--more-->

![](https://gitee.com/heptaluan/backups/raw/master/cdn/http/10-01.png)

下面我们就一步一步慢慢来梳理


## 诞生

`1989` 年 `3` 月，当时的互联网还只属于少数人，在这一互联网的黎明期，`HTTP` 诞生了，`CERN`（欧洲核子研究组织）的蒂姆·伯纳斯博士提出了一种能让远隔两地的研究者们共享知识的设想，
最初设想的基本理念是借助多文档之间相互关联形成的超文本（`HyperText`），连成可相互参阅的 `WWW`（`World Wide Web`，万维网），针对于此提出了三项 `WWW` 构建技术，分别是

* 把 `SGML`（`Standard Generalized Markup Language`，标准通用标记语言）作为页面的文本标记语言的 `HTML`（`HyperText Markup Language`，超文本标记语言）
* 作为文档传递协议的 `HTTP`
* 指定文档所在地址的 `URL`（`Uniform Resource Locator`，统一资源定位符）

`WWW` 这一名称，是 `Web` 浏览器当年用来浏览超文本的客户端应用程序时的名称，现在则用来表示这一系列的集合，也可简称为 `Web`


## 发展

`1990` 年 `11` 月，`CERN` 成功研发了世界上第一台 `Web` 服务器和 `Web` 浏览器，`1990` 年，大家针对 `HTML/1.0` 草案进行了讨论，因 `HTML/1.0` 中存在多处模糊不清的部分，草案被直接废弃了，接着从 `1993` 年开始，各公司之间爆发的浏览器大战就没有停息过，在这场浏览器供应商之间的竞争中，他们不仅对当时发展中的各种 `Web` 标准化视而不见，还屡次出现新增功能没有对应说明文档的情况，而在此过程当中，`HTTP` 的发展则是驻足不前的，各版本情况如下

#### HTTP/0.9

`HTTP` 于 `1990` 年问世，那时的 `HTTP` 并没有作为正式的标准被建立，现在的 `HTTP` 其实含有 `HTTP/1.0` 之前版本的意思，因此被称为 `HTTP/0.9`

#### HTTP/1.0

`HTTP` 正式作为标准被公布是在 `1996` 年的 `5` 月，版本被命名为 `HTTP/1.0`，并记载于 `RFC1945`，虽说是初期标准，但该协议标准至今仍被广泛使用在服务器端，地址如下

> RFC1945 - Hypertext Transfer Protocol - HTTP/1.0
>
> https://www.ietf.org/rfc/rfc1945.txt

#### HTTP/1.1

`1997` 年 `1` 月公布的 `HTTP/1.1` 是目前主流的 `HTTP` 协议版本，当初的标准是 `RFC2068`，之后发布的修订版 `RFC2616` 就是当前的最新版本，地址如下

> RFC2616 - Hypertext Transfer Protocol - HTTP/1.1
>
> https://www.ietf.org/rfc/rfc2616.txt

可见，作为 `Web` 文档传输协议的 `HTTP`，它的版本几乎没有更新（关于 `HTTP/2.0`，`HTTP/3.0` 相关知识我们会在后面进行介绍）



## 网络基础 TCP/IP

为了理解 `HTTP`，我们有必要事先了解一下 `TCP/IP` 协议族，通常使用的网络（包括互联网）是在 `TCP/IP` 协议族的基础上运作的，而 `HTTP` 属于它内部的一个子集

计算机与网络设备要相互通信，双方就必须基于相同的方法，比如如何探测到通信目标、由哪一边先发起通信、使用哪种语言进行通信、怎样结束通信等规则都需要事先确定，不同的硬件、操作系统之间的通信，所有的这一切都需要一种规则，而我们就把这种规则称为协议（`protocol`），协议中存在各式各样的内容，从电缆的规格到 `IP` 地址的选定方法、寻找异地用户的方法、双方建立通信的顺序，以及 `Web` 页面显示需要处理的步骤，等等

像这样把与互联网相关联的协议集合起来总称为 `TCP/IP`，`TCP/IP` 协议不仅仅指的是 `TCP` 和 `IP` 两个协议，而是指一个由 `FTP`、`SMTP`、`TCP`、`UDP`、`IP` 等协议构成的协议簇，只是因为在 `TCP/IP` 协议中 `TCP` 协议和 `IP` 协议最具代表性，所以被称为 `TCP/IP` 协议



#### 网络模型划分

我们在做开发的过程当中，常常会听说到各种协议，当前存在三种比较流行的划分网络模型的方式，如下

* `OSI` 七层模型
* `TCP/IP` 四层模型
* 五层模型

> 但是这里我们主要介绍 `TCP/IP` 四层模型，关于其他部分只做简单介绍，如果想要了解更多可以另行查阅相关书籍或文章

**OSI 七层模型**

`OSI`（`Open System Interconnection`，开放系统互连）七层网络模型称为开放式系统互联参考模型 ，是一个逻辑上的定义，一个规范，它把网络从逻辑上分为了七层，每一层都有相关、相对应的物理设备，比如路由器，交换机等，`OSI` 七层模型是一种框架性的设计方法，建立七层模型的主要目的是为解决异种网络互连时所遇到的兼容性问题，其主要的功能使就是帮助不同类型的主机实现数据传输，它的最大优点是将服务、接口和协议这三个概念明确地区分开来，通过七个层次化的结构模型使不同的系统不同的网络之间实现可靠的通讯，如下图

![](https://gitee.com/heptaluan/backups/raw/master/cdn/http/08-01.png)


**TCP/IP 四层模型**

`TCP/IP` 和 `OSI` 模型组并不能精确的匹配，但是我们可以尽可能的参考 `OSI` 模型并在其中找到 `TCP/IP` 的对应位置，`OSI` 模型到 `TCP/IP` 模型映射关系，通常人们认为 `OSI` 模型最上面三层（应用层、表示层、会话层）在 `TCP/IP` 中是一个应用层，由于 `TCP/IP` 有一个相对比较弱的会话层，由 `TCP` 和 `RTP` 下的打开和关闭连接组成，并在 `TCP/UDP` 下的各种应用提供不同的端口号，这些功能被单个的应用程序添加

那么 `TCP/IP` 四层模型跟 `OSI` 模型有什么不一样呢？

`OSI` 是一个完整的、完善的宏观理论模型，而 `TCP/IP` 模型，更加侧重的是互联网通信核心（也是就是围绕 `TCP/IP` 协议展开的一系列通信协议）的分层，因此它不包括物理层，以及其他一些不想干的协议，其次之所以说他是参考模型，是因为他本身也是 `OSI` 模型中的一部分，因此参考 `OSI` 模型对其进行分层


**五层模型**

五层体系结构包括应用层、运输层、网络层、数据链路层和物理层，五层协议只是 `OSI` 和 `TCP/IP` 的综合，实际应用还是 `TCP/IP` 的四层结构，它的意义其实是为了方便学习计算机网络原理而采用的，综合了 `OSI` 七层模型和 `TCP/IP` 的四层模型而得到的五层模型


#### TCP/IP 的分层管理

`TCP/IP` 协议族里重要的一点就是分层，`TCP/IP` 协议族按层次分别分为以下四层，即应用层、传输层、网络层和数据链路层，把 `TCP/IP` 层次化是有好处的，比如，如果互联网只由一个协议统筹，某个地方需要改变设计时，就必须把所有部分整体替换掉，而分层之后只需把变动的层替换掉即可，把各层之间的接口部分规划好之后，每个层次内部的设计就能够自由改动了

值得一提的是，层次化之后，设计也变得相对简单了，处于应用层上的应用可以只考虑分派给自己的任务，而不需要弄清对方在地球上哪个地方、对方的传输路线是怎样的、是否能确保传输送达等问题，`TCP/IP` 协议族各层的作用如下

名称|释义
-|-
应用层 | 应用层决定了向用户提供应用服务时通信的活动，`TCP/IP` 协议族内预存了各类通用的应用服务，比如 `FTP` 和 `DNS` 服务就是其中两类，`HTTP` 协议也处于该层
传输层 | 传输层对上层应用层，提供处于网络连接中的两台计算机之间的数据传输，在传输层有两个性质不同的协议 `TCP` 和 `UDP`
网络层（又名网络互连层） | 网络层用来处理在网络上流动的数据包，数据包是网络传输的最小数据单位，该层规定了通过怎样的路径（所谓的传输路线）到达对方计算机，并把数据包传送给对方，与对方计算机之间通过多台计算机或网络设备进行传输时，网络层所起的作用就是在众多的选项内选择一条传输路线
链路层（又名数据链路层，网络接口层） | 用来处理连接网络的硬件部分，包括控制操作系统、硬件的设备驱动、`NIC`（网络适配器），及光纤等物理可见部分（还包括连接器等一切传输媒介），硬件上的范畴均在链路层的作用范围之内



#### TCP/IP 通信传输流

利用 `TCP/IP` 协议族进行网络通信时，会通过分层顺序与对方进行通信，发送端从应用层往下走，接收端则往应用层往上走

![](https://gitee.com/heptaluan/backups/raw/master/cdn/http/10-02.png)

我们用 `HTTP` 举例来说明，首先作为发送端的客户端在应用层（`HTTP` 协议）发出一个想看某个 `Web` 页面的 `HTTP` 请求，接着为了传输方便，在传输层（`TCP` 协议）把从应用层处收到的数据（`HTTP` 请求报文）进行分割，并在各个报文上打上标记序号及端口号后转发给网络层

在网络层（`IP` 协议）增加作为通信目的地的 `MAC` 地址后转发给链路层，这样一来发往网络的通信请求就准备齐全了，接收端的服务器在链路层接收到数据，按序往上层发送，一直到应用层，当传输到应用层，才能算真正接收到由客户端发送过来的 `HTTP` 请求

![](https://gitee.com/heptaluan/backups/raw/master/cdn/http/10-03.png)

发送端在层与层之间传输数据时，每经过一层时必定会被打上一个该层所属的首部信息，反之接收端在层与层传输数据时，每经过一层时会把对应的首部消去，这种把数据信息包装起来的做法称为封装（`encapsulate`）







<!-- 此时就需要借助“ARP协议”将目标主机的IP地址转换为对应主机的MAC地址才能进行通信 -->
