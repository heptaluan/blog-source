---
title: JavaScript 中的垃圾回收机制
date: 2017-12-25
categories: Essay
tags: Essay
toc: true
thumbnail: https://gitee.com/heptaluan/backups/raw/master/cdn/cover/02.jpg
---

先来看看《`JavaScript` 权威指南》当中关于垃圾回收机制的介绍

<!--more-->

* 由于字符串、对象和数组没有固定大小，所有当他们的大小已知时，才能对他们进行动态的存储分配

* `JavaScript` 程序每次创建字符串、数组或对象时，解释器都必须分配内存来存储那个实体

* 只要像这样动态地分配了内存，最终都要释放这些内存以便他们能够被再用，否则，`JavaScript` 的解释器将会消耗完系统中所有可用的内存，造成系统崩溃

现在各大浏览器通常用采用的垃圾回收有两种方法：**标记清除**、**引用计数**

## 标记清除

这是 `JavaScript` 中最常用的垃圾回收方式

当变量进入执行环境是，就标记这个变量为 **进入环境**，从逻辑上讲，永远不能释放进入环境的变量所占用的内存，因为只要执行流进入相应的环境，就可能会用到他们，当变量离开环境时，则将其标记为 **离开环境**

## 引用计数

另一种不太常见的垃圾回收策略是引用计数（有时候会造成内存泄漏，一般发生在循环引用）

引用计数的含义是跟踪记录每个值被引用的次数，当声明了一个变量并将一个引用类型赋值给该变量时，则这个值的引用次数就是 `1`

相反，如果包含对这个值引用的变量又取得了另外一个值，则这个值的引用次数就减 `1`

当这个引用次数变成 `0` 时，则说明没有办法再访问这个值了，因而就可以将其所占的内存空间给收回来

这样，垃圾收集器下次再运行时，它就会释放那些引用次数为 `0` 的值所占的内存